#labels Featured
<wiki:toc max_depth="3" />

=General Features=

=== Filename Parsing===

When an archive is opened, and it has no tags, ComicTagger will attempt to parse the filename to glean some information.  Generally, it expects a format similar to this:

{{{
SERIES_NAME vVOLNUM ISSUENUM (of COUNT) (YEAR).ext
}}}

i.e.

{{{
Plastic Man v1 002 (1942).cbz
Blue Beetle 02.cbr
Crazy Weird Comics 2 (of 2) (1969).rar
}}}

(In this scheme, the YEAR refers to publication year of the issue.)

The cleaner the original filename is, the better ComicTagger is at matching online.

===Automatic Identification and Tagging===

ComicTagger uses an image processing technique to compare the cover image of an archive with images found online to determine the correct metadata.  

When an online search and auto-identification is attempted, ComicTagger will use the series name, issue number, and optionally the publication year to find the best match.  Once the list of possibilities is narrowed, it will compare cover images to find the right choice. 

_(If the filename parsing failed to properly fill in the series name and number, you can manually enter those fields before you do the auto-select.)_ 

Obstacles to this process are alternate covers, duplicate covers ( such as multiple editions with the same numbering and virtually identical covers), improperly or poorly named files, and mis-sequenced cover images in the archive.

The settings allow the user to mitigate some of these problems by blacklisting certain publishers, and narrowing the name matching.

===Caching===

ComicTagger caches online search results and images from ComicVine in a temporary database to improve speed when doing similar searches repeatedly. 

=== RAR Tools ===

In order to read and write RAR and CBR archives, you will need to download tools from [http://www.win-rar.com/download.html WinRAR]. You may need to specify the tool locations via the settings/preferences dialog.

ComicTagger uses the command-line tools "rar" and "unrar", which, despite the warnings of the WinRAR GUI, don't seem to expire.  So, no need to pay!

===Rename===

Renaming based on tag data is available, and a template can be set via the GUI settings dialog, or directly editing the settings file.

The template string accepts the following variables:

<code language="bat">
%series%
%issue%
%issuecount%
%volume%
%year%
%title%
%publisher%</code>

For example, the template:

{{{%series% #%issue% (%year%)}}}

might yield the name:

{{{Plastic Man #002 (1944)}}}

A "smart text cleanup" can optionally remove extra characters if some of the variables have empty values.  For example, if there is no publication year available, the smart cleanup will remove the empty parentheses in the above example.

===Settings===
ComicTagger keeps the program settings (and caches) in a special folder.  On Windows, you might find it in a folder like:

<code language="bat">
C:\Users\usrname\AppData\roaming\ComicTagger
</code>

This might be a little different, depending on your version of Windows

On Unix systems, (including Mac) something like this:
<code language="sh">
/Users/username/.ComicTagger
</code>

or 

<code language="sh">
/home/username/.ComicTagger
</code>


The settings for the app affect both GUI and CLI mode.  If you're using the GUI, everything in the settings folder can be changed via the app.
If only using CLI mode, you might want to edit things such as RAR program location, and identifier settings.

The setting file itself is a standard "ini" format, and very human-readable.

{{{
[settings]
rar_exe_path = /usr/bin/rar
unrar_exe_path = /usr/bin/unrar

[auto]
last_selected_load_data_style = 0
last_selected_save_data_style = 0
last_opened_folder = 
last_main_window_width = 1096
last_main_window_height = 611
last_main_window_x = 252
last_main_window_y = 294
last_form_side_width = 763
last_list_side_width = 309

[identifier]
id_length_delta_thresh = 5
id_publisher_blacklist = Panini Comics, Abril, Scholastic Book Services

[dialogflags]
ask_about_cbi_in_rar = True
show_disclaimer = True

[comicvine]
use_series_start_as_volume = False

[cbl_transform]
assume_lone_credit_is_primary = False
copy_characters_to_tags = False
copy_teams_to_tags = False
copy_locations_to_tags = False
copy_notes_to_comments = False
copy_weblink_to_comments = False
apply_cbl_transform_on_cv_import = False
apply_cbl_transform_on_bulk_operation = False

[rename]
rename_template = %series% #%issue% (%year%)
rename_issue_number_padding = 3
rename_use_smart_string_cleanup = True
rename_extension_based_on_archive = True
}}}

= GUI User Guide =

The GUI is for the most part pretty intuitive.  You open files or folders via the menu, or by drag-and-drop, edit the tag fields, and save.  But a some portions deserve a few words.

=== Archive List ===
The right side of the main window is a list of all the comic files that have been opened by ComicTagger.  As each file is read in, its existing metadata and other information are parsed and cached for quick browsing.  Changing main selections in the list will cause the form to update, depending on which "Read Style" is selected.  A right-click context menu is available for easy access to batch functions.

Multiple archives can be selected for batch operations.

=== Tag Style Drop-downs ===

The "Read Style" and "Modify Style" drop-down selections in the upper corner select which tags are shown in the form, and how the tags will be saved. 

When the "Modify Style" is changed, certain entry fields will change color, and go inactive if those fields won't be saved for the selected style.  For example, the ComicRack tag style doesn't support a field for "Country", so that entry control will be marked red, and made inactive. This block also affects the tag removal menu option, auto-tag, save, and the copy destination tag block. 

The "Read Style" affects which tag block shown in the form when the user changes the list selection. This drop-down also affects which tags will be used in renaming, and the source tag block for a copy operation.

=== Search vs. Auto-Identify vs. Auto-Tag===

The ComicTagger GUI offers several different ways to acquire tags online:

The "Search" function uses only the text that has been entered in the "Series" field of the form.  It offers an entirely interactive method for tagging. It affects only the data in the form.

"Auto-Identify" uses the "Series", "Issue", and "Year" fields in the form.  It will attempt to compare covers of comics online to determine the best match.  When done, it will fill in the form, same as the "Search" function

"Auto-Tag" does not use the form data at all.  It is meant to be used with many files at once, and will use any metadata in the file and the file names as search keys.  As it matches comics, it will write out the tag automatically. 

===Page Browser===

Double-clicking on the cover image, or selecting the Page Browser menu option/toolbar button will bring up a very simple page broswer.  It's meant to allow the user to to inspect pages of the archive to glean hints about metadata, and is in no way meant to be a comic reader.

===Page List Editor===

The page list editor tab allows the user to change order that pages are display, and assign different page types.  The page list order can be changed by using the up and down buttons, or by dragging and dropping.

= CLI User Guide =

ComicTagger supports a powerful command-line interface that can be used for batch processing of archives.

On the command-line just invoke the main executable with options.   

On Windows the executable path should be something like this:

<code language="bat">
C:\Program Files\ComicTagger\comictagger.exe
</code>

On Mac something like this:
<code language="sh">
/Applications/ComicTagger.app/Contents/MacOS/ComicTagger
</code>

 Since that is a little ungainly, you might want to consider running the following so you can just use "ComicTagger" from your shell prompt:
 <code language="sh">
 sudo mkdir -p /usr/local/bin
sudo ln -s /Applications/ComicTagger.app/Contents/MacOS/ComicTagger  /usr/local/bin 
 </code>


If running from python source, just run "comictagger.py"

Here is the help message:
<code language="txt">
Usage: ComicTagger [OPTION]... [FILE LIST]

A utility for reading and writing metadata to comic archives.

If no options are given, comictagger.py will run in windowed mode

  -p, --print                Print out tag info from file.  Specify type
                             (via -t) to get only info of that tag type
      --raw                  With -p, will print out the raw tag block(s)
                             from the file
  -d, --delete               Deletes the tag block of specified type (via -t)
  -c, --copy=SOURCE          Copy the specified source tag block to destination style
                             specified via via -t (potentially lossy operation)
  -s, --save                 Save out tags as specified type (via -t)
                             Must specify also at least -o, -p, or -m
      --nooverwrite          Don't modify tag block if it already exists ( relevent for -s or -c )  
  -n, --dryrun               Don't actually modify file (only relevent for -d, -s, or -r)
  -t, --type=TYPE            Specify TYPE as either "CR", "CBL", or "COMET" (as either 
                             ComicRack, ComicBookLover, or CoMet style tags, respectivly)
  -f, --parsefilename        Parse the filename to get some info, specifically
                             series name, issue number, volume, and publication 
                             year
  -i, --interactive          Interactively query the user when there are multiple matches for
                             an online search
      --nosummary            Suppress the default summary after a save operation
  -o, --online               Search online and attempt to identify file using 
                             existing metadata and images in archive. May be used
                             in conjuntion with -f and -m
      --id=ID                Use the issue ID when searching online.  Overrides all other metadata
  -m, --metadata=LIST        Explicity define, as a list, some tags to be used                           
                                e.g. "series=Plastic Man , publisher=Quality Comics"
                                     "series=Kickers^, Inc., issue=1, year=1986"
                             Name-Value pairs are comma separated.  Use a "^" to 
                             escape an "=" or a ",", as shown in the example above
                             Some names that can be used:
                                 series, issue, issueCount, year, publisher, title
  -r, --rename               Rename the file based on specified tag style.
      --noabort              Don't abort save operation when online match is of low confidence  
  -v, --verbose              Be noisy when doing what it does                            
      --terse                Don't say much (for print mode)                            
      --version              Display version                            
  -h, --help                 Display this message 
</code>

Here are some sample usages, that assume running from bash shell on a Mac or other UNIX system.  If using Mac or Windows binary versions, substitute the correct ComicTagger command, as mentioned above.

Print out the tags for a single file
<code language="sh">
./comictagger.py -p Plastic_Man_001_.zip
</code>

Print out the ComicRack tags for all CBZ files in the folder
<code language="sh">
./comictagger.py -p -t cr *.cbz
</code>

Delete the ComicBookLover tags for all CBR files in the folder
<code language="sh">
./comictagger.py -d -t cbl *.cbr
</code>

Set the ComicRack tags from online for a single file, using the filename to search
<code language="sh">
./comictagger.py -s -t cr -f  -o Plastic_Man_001_.cbr
</code>

Search online for for a single file, using the specified tags to search, be verbose, and save to ComicRack tags
<code language="sh">
./comictagger.py -s -t cr -m "series=Plastic Man,issue=1"  -o -v PlasMan001.cbr
</code>

Set the ComicBookLover Publisher tag for a list of files
<code language="sh">
./comictagger.py -s -t cbl -m "publisher=Quality Comics"   Plastic\ Man*.*
</code>

As above, but in "dry run" mode, where it just displays what would be saved
<code language="sh">
./comictagger.py -n -s -t cbl -m "publisher=Quality Comics"   Plastic\ Man*.*
</code>

Search online for for a list of files, using the filename to search, interactively ask the user at the end (if needed) and save to ComicRack tags
<code language="sh">
./comictagger.py -s -t cr -f  -o -i *.cbr
</code>

As above, but un-sets any year found in the filenames
<code language="sh">
./comictagger.py -s -t cr -f  -o -i  -m "year=" *.cbr
</code>

Rename a file based on ComicRack tags
<code language="sh">
./comictagger.py -r -t cr PlasticManOne.cbz
</code>

Copy the ComicBookLover tags in an archive  to ComicRack tags
<code language="sh">
./comictagger.py -c cbl -t cr PlasticManOne.cbz
</code>

The following examples make use of the "find" command do do recursive searches:

Recursively tag all comics (without ComicRack tags already) under the current folder
<code language="sh">
find . -name \*.cb\* |  sed 's/.*/"&"/' |  xargs ./comictagger.py -s -f -o -t cr --nooverwrite -i 
</code>

Recursively copy all ComicRack tags to CBL tags
<code language="sh">
find . -name \*.cb\* |  sed 's/.*/"&"/' |  xargs ./comictagger.py -c cr -t cbl  
</code>